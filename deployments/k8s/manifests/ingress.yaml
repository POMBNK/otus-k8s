#* After the addon is enabled, please run "minikube tunnel" and your ingress resources would be available at "127.0.0.1"
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
    name: kuber-ingress
    annotations:
      nginx.ingress.kubernetes.io/rewrite-target: "/$2"
      nginx.ingress.kubernetes.io/use-regex: "true"
spec:
    ingressClassName: nginx
    rules:
    - host: arch.homework
      http:
        paths:
#          - path: /()(.*)
#            pathType: ImplementationSpecific

#          - path: /health
#            pathType: Prefix
#            backend:
#              service:
#                name: kuber-service
#                port:
#                  number: 80
          - path: /^otusapp/([^/]+)/health$
            pathType: ImplementationSpecific
            backend:
              service:
                name: kuber-service
                port:
                  number: 80
          - path: /^health$
            pathType: ImplementationSpecific
            backend:
              service:
                name: kuber-service
                port:
                  number: 80


#          - path: /otusapp/\w+(/|$)(.*)
#            pathType: ImplementationSpecific
#            backend:
#              service:
#                name: kuber-service
#                port:
#                  number: 80